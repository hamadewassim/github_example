
Applied DataScience - Clustering Localities in Kolkata, India
Arghyadeep Ganguly
28th JAN 2020
Introduction/Business Problem
In our citi of Kolkata(India), famously known as City Of Joy , Kolkata is the commercial and financial hub of East and North-East India and home to the Calcutta Stock Exchange.It is a major commercial and military port, and is the only city in eastern India, apart from Bhubaneswar to have an international airport.

Around 6 million people lives in this city with population density of 22 thousand people per square kilometer. This city has been devided into 140 wards. When we think of it by the investor, we expect from them to prefer the districts where the type of business they want to install is less intense. If we think of the city residents, they may want to choose the regions where real estate values are lower, too. At the same time, they may want to choose the district according to the social places density. However, it is difficult to obtain information that will guide investors in this direction, nowadays.

A short description of the useful data
There are no available dataset in csv/json/xls format which has enlisted all Kolkata negubourhoods with latitiude and lomgitude data.

This data is only available in Wikipedia. Every Kolkata Corporation Wards have a separate Wiki pages and that contains geospatial data. I am planning to run a process that will hit every Wikipedia page (for each Kolkata ward) and will collect relevent information.

An Example Kolkata Corporation Ward Page - "https://en.wikipedia.org/wiki/Ward_No._1,_Kolkata_Municipal_Corporation"

Exmaple Data Set, That can be extracted from Wiki Pages

Coordinates: 22.617889°N 88.370556°ECoordinates: 22.617889°N 88.370556°E Country : India State: West Bengal City: Kolkata Neighbourhood covered : Cossipore Police station: Cossipore Parliamentary constituency: Kolkata Uttar Assembly constituency: Kashipur-Belgachhia

We will consider to pull Coordinates, Ward No and Assembly constituency( as Neighbourhood).

Our next dataset would be Fousqaure venue data. After collecting nearby venues for available kolkata geographical points, those will be filtered to consider only categories which can be marked as eatries.

After analyzing Foursquare Explore api data set which can be accessed with below API calls

https://api.foursquare.com/v2/venues/explore?&client_id={}&client_secret={}&v={}&ll={},{}&radius={}&limit={}

Methodology
Data Collection
There are no available dataset in csv/json/xls format which has enlisted all Kolkata negubourhoods with latitiude and lomgitude data.

This data is only available in Wikipedia. Every Kolkata Corporation Wards have a separate Wiki pages and that contains geospatial data. I am planning to run a process that will hit every Wikipedia page (for each Kolkata ward) and will collect relevent information.

An Example Kolkata Corporation Ward Page - "https://en.wikipedia.org/wiki/Ward_No._1,_Kolkata_Municipal_Corporation"

Exmaple Data Set, That can be extracted from Wiki Pages

Coordinates: 22.617889°N 88.370556°ECoordinates: 22.617889°N 88.370556°E Country : India State: West Bengal City: Kolkata Neighbourhood covered : Cossipore Police station: Cossipore Parliamentary constituency: Kolkata Uttar Assembly constituency: Kashipur-Belgachhia

We will consider to pull Coordinates, Ward No and Assembly constituency( as Neighbourhood).

Our next dataset would be Fousqaure venue data. After collecting nearby venues for available kolkata geographical points, those will be filtered to consider only categories which can be marked as eatries.

After analyzing Foursquare Explore api data set which can be accessed with below API calls

https://api.foursquare.com/v2/venues/explore?&client_id={}&client_secret={}&v={}&ll={},{}&radius={}&limit={}

Import and Install all required Packages
Panadas & Numpy - For Data extraction and manipulation

Folium & Geopy - For gespatial Data analysis

Matplotlib - Charts

In [2]:
!conda install -c conda-forge folium=0.10.1
!conda install -c conda-forge geopy --yes 

import pandas as pd
import numpy as np

import folium
from geopy.geocoders import Nominatim 
import requests
import json
from pandas.io.json import json_normalize

import matplotlib.cm as cm
import matplotlib.colors as colors

#import k-means from clustering stage
from sklearn.cluster import KMeans
Solving environment: done

## Package Plan ##

  environment location: /opt/conda/envs/Python36

  added / updated specs: 
    - folium=0.10.1


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    ca-certificates-2019.11.28 |       hecc5488_0         145 KB  conda-forge
    openssl-1.1.1d             |       h516909a_0         2.1 MB  conda-forge
    vincent-0.4.4              |             py_1          28 KB  conda-forge
    certifi-2019.11.28         |           py36_0         149 KB  conda-forge
    folium-0.10.1              |             py_0          59 KB  conda-forge
    branca-0.3.1               |             py_0          25 KB  conda-forge
    ------------------------------------------------------------
                                           Total:         2.5 MB

The following NEW packages will be INSTALLED:

    branca:          0.3.1-py_0        conda-forge
    folium:          0.10.1-py_0       conda-forge
    vincent:         0.4.4-py_1        conda-forge

The following packages will be UPDATED:

    ca-certificates: 2019.11.27-0                  --> 2019.11.28-hecc5488_0 conda-forge
    certifi:         2019.11.28-py36_0             --> 2019.11.28-py36_0     conda-forge

The following packages will be DOWNGRADED:

    openssl:         1.1.1d-h7b6447c_3             --> 1.1.1d-h516909a_0     conda-forge


Downloading and Extracting Packages
ca-certificates-2019 | 145 KB    | ##################################### | 100% 
openssl-1.1.1d       | 2.1 MB    | ##################################### | 100% 
vincent-0.4.4        | 28 KB     | ##################################### | 100% 
certifi-2019.11.28   | 149 KB    | ##################################### | 100% 
folium-0.10.1        | 59 KB     | ##################################### | 100% 
branca-0.3.1         | 25 KB     | ##################################### | 100% 
Preparing transaction: done
Verifying transaction: done
Executing transaction: done
Solving environment: done

## Package Plan ##

  environment location: /opt/conda/envs/Python36

  added / updated specs: 
    - geopy


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    geographiclib-1.50         |             py_0          34 KB  conda-forge
    geopy-1.20.0               |             py_0          57 KB  conda-forge
    ------------------------------------------------------------
                                           Total:          91 KB

The following NEW packages will be INSTALLED:

    geographiclib: 1.50-py_0   conda-forge
    geopy:         1.20.0-py_0 conda-forge


Downloading and Extracting Packages
geographiclib-1.50   | 34 KB     | ##################################### | 100% 
geopy-1.20.0         | 57 KB     | ##################################### | 100% 
Preparing transaction: done
Verifying transaction: done
Executing transaction: done
In [3]:
import matplotlib as mpl
import matplotlib.pyplot as plt

mpl.style.use('ggplot')
In [4]:
CLIENT_ID = 'FWTZSMHN2LO3ASEOMNMJKKROKEJM0BWXS34XGRY4TSCEBQ4Y' # your Foursquare ID
CLIENT_SECRET = 'M4GZJY12ZXNG4KRAZIQQZVNFPIINOLHTPLIG1QRKTRS3IWKJ' # your Foursquare Secret
VERSION = '20190605' # Foursquare API version

print('Your credentails:')
print('CLIENT_ID: ' + CLIENT_ID)
print('CLIENT_SECRET:' + CLIENT_SECRET)
Your credentails:
CLIENT_ID: FWTZSMHN2LO3ASEOMNMJKKROKEJM0BWXS34XGRY4TSCEBQ4Y
CLIENT_SECRET:M4GZJY12ZXNG4KRAZIQQZVNFPIINOLHTPLIG1QRKTRS3IWKJ
Extracting Corodinates from Web scrapped Data
Now, We will start collecting/ preparing our data from Kolkata Corporatin Wiki Pages. We have used Pandas read_html(link) method to read data from Wiki pages. We are interested to collect data of "Ward no", "Ward Name", "Borough", "Postal Code", "locality","latitude","longitude".

In this data preparation phase, We will iterate through all available Wiki pages for all 144 Wards.

Issues We have faced during Extraction :-

a) Extracted text data for coordinates include junk charecters like - "\ufeff"

b) Coordinates includes "°E" and "°N". This suffix information has to be revomed to work with Folium maps.

In [5]:
def extract_longitude_latitude (coordinates):
    #first \ufeff location
    sub_startindex = coordinates.index("\ufeff") + 5 # length of the junk text
    sub_endindex = coordinates[sub_startindex:].index("Coordinates")
    stage_one_coordinates = coordinates[sub_startindex: sub_startindex+sub_endindex]
    lst_lat_lang = stage_one_coordinates.rsplit(" ")
    return  lst_lat_lang [1].replace("°E",""), lst_lat_lang [0].replace("°N","")
In [6]:
npary = np.array([["ward_no","ward","borough","postalcode","locality","latitude","longitude"]])
In [7]:
def populate_details_wardwise(src_dtframe):
    
    var_ward_no ='{0}'.format(activeward_no)
    var_ward = src_dtframe[second_column][src_dtframe[first_column].isin(['Neighbourhoods covered','Neighbourhood covered','Neighbourhoods','Neighbourhood']) ].to_string(index=False).strip()
    var_bor = src_dtframe[second_column][src_dtframe[first_column].isin (['Burough' , 'Borough']) ].to_string(index=False).strip()
    var_postal = src_dtframe[second_column][src_dtframe[first_column] == 'PIN' ].to_string(index=False).strip()
    var_local = src_dtframe[second_column][src_dtframe[first_column] == 'Assembly constituency' ].to_string(index=False).strip()

    coordinates = src_dtframe[second_column][2]
    var_lang,var_lat = extract_longitude_latitude(coordinates)
    return [[var_ward_no,var_ward,var_bor,var_postal,var_local,var_lat,var_lang]]
In [8]:
maxward_no = 144
activeward_no = 1

while activeward_no <= maxward_no:
    
    first_column = 'Ward No. {0}'.format(activeward_no)
    second_column = 'Ward No. {0}.1'.format(activeward_no)

    link = "https://en.wikipedia.org/wiki/Ward_No._{0},_Kolkata_Municipal_Corporation".format(activeward_no)
    tables = pd.read_html(link)
    rw_dtframe = pd.DataFrame(tables[0])
    npary = np.concatenate((npary,populate_details_wardwise(rw_dtframe)) ,axis =0)
    activeward_no += 1
#print(npary)
Extracted Data frame
The below output will show, how the initial data frame with extracted data will looklike

In [9]:
pd.set_option('display.max_rows', None)

df_kolkata = pd.DataFrame(npary)
df_kolkata.columns = df_kolkata.iloc[0]
df_kolkata = df_kolkata[1:]
df_kolkata = df_kolkata.astype({"borough":int, "longitude":float , "latitude":float},inplace=True)
df_kolkata.sort_values(['borough'],ascending=True)
Out[9]:
ward_no	ward	borough	postalcode	locality	latitude	longitude
1	1	Cossipore	1	700 003	Kashipur-Belgachhia	22.617889	88.370556
2	2	Sinthee (Ramlila Bagan-Biswanath Colony-Roypar...	1	700 050	Kashipur-Belgachhia	22.628056	88.384444
3	3	Belgachia, Duttabagan	1	700 037	Kashipur-Belgachhia	22.604444	88.383333
4	4	Paikpara	1	700 002/ 700 037	Kashipur-Belgachhia	22.613056	88.379444
5	5	Tala	1	700 002	Kashipur-Belgachhia	22.608889	88.379694
6	6	Chitpur, Cossipore	1	700 002	Kashipur-Belgachhia	22.610863	88.371213
7	7	Bagbazar	1	700 003	Shyampukur	22.603567	88.365806
8	8	Bagbazar, Shyampukur	1	700 003	Shyampukur	22.601806	88.366500
9	9	Shobhabazar, Kumortuli	1	700 004	Shyampukur	22.595889	88.365306
20	20	Shobhabazar, Ahiritola	2	700 049	Shyampukur	22.593556	88.354667
19	19	Ahiritola and Beniatola	2	700 004	Shyampukur	22.595667	88.357667
18	18	Shobhabazar	2	700 004	Shyampukur	22.593667	88.362861
17	17	Shobhabazar, Darjipara	2	700 128	Shyampukur	22.595378	88.365556
16	16	Maniktala (Bangiya Sahitya Parishad-Goa Bagan)	2	700 009	Maniktala	22.591278	88.371361
15	15	Maniktala (Bangiya Sahitya Parishad-Halsi Baga...	2	700 009	Maniktala	22.590278	88.376556
12	12	Shyambazar (Fariapukur)	2	700 004	Maniktala	22.596806	88.376694
11	11	Shyambazar, Burtolla, Hatibagan	2	700 004	Maniktala	22.598806	88.373611
10	10	Shyambazar, Shobhabazar, Shyampukur	2	700 004	Shyampukur	22.597889	88.364326
14	14	Ultadanga (Murari Pukur), Bagmari	3	700 067	Maniktala	22.589278	88.385556
13	13	Ultadanga (Daspara-Muchi Bazar-Telenga Bagan-S...	3	700 067	Maniktala	22.594167	88.385889
35	35	Beliaghata (Kundu Bagan-Kulia), Phoolbagan	3	700 010	Beleghata	22.567861	88.384306
34	34	Beliaghata (Ganguly Bagan-Uria Bagan-Kulia)	3	700 010	Beleghata	22.564861	88.389306
33	33	Phoolbagan (Subhas Sarovar), Beliaghata (Kulia)	3	700 006	Beleghata	22.564861	88.399306
32	32	Kankurgachi, Bagmari, Ultadanga (Murari Pukur-...	3	700 006	Maniktala	22.582861	88.391917
31	31	Kankurgachi, Phoolbagan (Kadapara)	3	700 006	Maniktala	22.579861	88.388917
30	30	Narkeldanga, Phoolbagan, Kankurgachi	3	700 011	Beleghata	22.576250	88.387528
29	29	Narkeldanga	3	700 011	Beleghata	22.579250	88.379833
39	39	Marcus Square, College Street, Simla	4	700 007	Jorasanko	22.579667	88.362861
38	38	Rajabazar, Amherst Street	4	700 009	Jorasanko	22.579167	88.370861
21	21	Jorabagan	4	700 047	Shyampukur	22.592167	88.352472
27	27	Maniktala	4	700 006	Jorasanko	22.585250	88.372333
26	26	Ramdulal Sarkar Street and Hedua Park	4	700 006	Shyampukur	22.587250	88.365028
25	25	Rambagan, Girish Park, Jorasanko, Simla	4	700 006	Jorasanko	22.587761	88.361251
24	24	Pathuriaghata	4	700 006	Shyampukur	22.588472	88.356361
23	23	Posta, Jorasanko	4	700 007	Jorasanko	22.584667	88.356667
22	22	Posta	4	700 007	Jorasanko	22.586861	88.351667
28	28	Maniktala, Garpar, Rajabazar	4	700 006	Beleghata	22.580250	88.375833
50	50	Bowbazar (Lebutala), Taltala, Moulali, Sealdah	5	700 012	Chowranghee	22.565900	88.363300
49	49	Bowbazar, Sealdah (Baithakkhana)	5	700 012	Chowranghee	22.568235	88.367611
45	45	Esplanade West, Eden Gardens, Babughat, Millen...	5	700 001	Chowranghee	22.568889	88.346167
48	48	Bowbazar	5	700 012	Chowranghee	22.568249	88.361389
44	44	Burrabazar (Mechhua), Tiretta Bazaar, Colootol...	5	700 007	Chowranghee	22.574889	88.357361
36	36	Beliaghata (Barafkal), Sealdah, Rajabazar	5	700 009, 700 010	Beleghata	22.566861	88.376972
42	42	Burrabazar	5	700 007	Jorasanko	22.580313	88.352673
41	41	Jorasanko	5	700 006	Jorasanko	22.582278	88.359167
43	43	Burrabazar (Mechhua), Kolutola	5	700 073	Jorasanko	22.576889	88.359167
40	40	College Street, College Square, Patuatola, Nar...	5	700 007	Jorasanko	22.575461	88.364361
37	37	Sealdah (Baithakkhana), Rajabazar	5	700 009	Jorasanko	22.574861	88.369861
60	60	Park Circus (Beniapukur)	6	700 017	Ballygunge	22.547333	88.369325
55	55	Sealdah, Entally	6	700 014	Entally	22.554245	88.372811
54	54	Entally	6	700 014	Entally	22.558685	88.368611
61	61	Park Circus (Nonapukur-Beniapukur), Park Stree...	6	700 016	Ballygunge	22.549639	88.359250
53	53	Taltala, Moulali	6	700 014	Chowranghee	22.558245	88.361611
51	51	Bowbazar, Taltala	6	700 012	Chowranghee	22.565245	88.362611
47	47	Bowbazar (Chandni Chowk), Dharmatala	6	700 012	Chowranghee	22.568250	88.359611
46	46	Chowringhee, Esplanade East, Dharmatala, Janba...	6	700 069	Chowranghee	22.567250	88.350722
52	52	Taltala (Collin Street-Marquis Street), Janbazar	6	700 014	Chowranghee	22.558245	88.356611
62	62	Taltala (Ripon Street-Alimuddin Street), Moulali	6	700 016	Chowrangee	22.554839	88.360625
67	67	Tiljala (Kata Pukur-Bediadanga), Kasba (Natore...	7	700 107	Kasba	22.523889	88.376444
66	66	Tangra (Chinatown), Topsia, Science City, Foru...	7	700 039	Kasba	22.531861	88.385444
65	65	Ballygunge (Ballygunge Park), Park Circus (Gob...	7	700 029	Ballygunge	22.531667	88.368444
64	64	Park Street (Mullick Bazar), Park Circus (Beni...	7	700 017	Ballygunge	22.541217	88.364333
58	58	Tangra (Seal Lane), Dhapa (Mathpukur), East Ko...	7	700 014	Entally	22.543333	88.397250
59	59	Park Circus (Beniapukur-Gobra), Tangra (Seal L...	7	700 046	Entally	22.545333	88.377125
57	57	Tangra (Munshi Bazar-Canal South Road-Metropol...	7	700 014	Beleghata	22.559333	88.389611
56	56	Entally, Tangra (Seal Lane)	7	700 014	Entally	22.555250	88.378611
63	63	Chowringhee, Taltala (Ripon Street-Royd Street...	7	700 016	Bhabanipur	22.546639	88.352444
85	85	Ballygunge (Deshapriya Park)	8	700 029	Ballygunge	22.521141	88.356306
90	90	Ballygunge (Lake Terrace), Rabindra Sarobar, D...	8	700 029	Rashbehari	22.514222	88.366694
87	87	Kalighat (Lake Market-Lake Range-Mudiali)	8	700 029	Rashbehari	22.513917	88.350694
86	86	Ballygunge (Lake Terrace-Keyatala), Gariahat (...	8	700 029	Rashbehari	22.518917	88.364306
83	83	Kalighat	8	700 023	Rashbehari	22.521455	88.342611
72	72	Bhowanipore (Chakraberia-Paddapukur-Bakulbagan)	8	700 020	Bhabanipur	22.528583	88.348472
68	68	Ballygunge (Ballygunge Place-Ekdalia-Ballygung...	8	700 029	Ballygunge	22.521889	88.368472
69	69	Ballygunge, Beck Bagan	8	700 029	Ballygunge	22.529889	88.359472
70	70	Bhowanipore (Sreepally-Jadubabur Bazar)	8	700 020	Bhabanipur	22.537889	88.350472
73	73	Bhowanipore (Patuapara), Kalighat	8	700 026	Bhabanipur	22.527889	88.343472
78	78	Ekbalpur, Mominpur	9	700 023, 700 027	Kolkata Port	22.528944	88.324235
77	77	Kidderpore (Dr. Sudhir Bose Road)	9	700 023	Bhabanipur	22.536944	88.323861
88	88	Kalighat (Sahanagar-Lalpara)	9	700 026	Rashbehari	22.514917	88.343694
75	75	Hastings, Watgunge	9	700 023	Kolkata Port	22.546944	88.323472
76	76	Watgunge, Kidderpore (Andaman Dock)	9	700 023	Kolkata Port	22.541944	88.317861
71	71	Bhowanipore	9	700 020	Bhabanipur	22.532889	88.343472
74	74	Alipore	9	700 027, 700 053	Bhabanipur	22.525889	88.330472
82	82	Chetla	9	700 053	Bhabanipur	22.517345	88.335611
80	80	Kidderpore (Andaman Dock), Garden Reach (BNR C...	9	700 023	Kolkata Port	22.540325	88.300161
79	79	Kidderpore (Babu Bazar), Mominpur, Majherhat, ...	9	700 023	Kolkata Port	22.533250	88.310611
84	84	Kalighat, Manoharpukur	9	700 029	Rashbehari	22.518435	88.349417
96	96	Jadavpur (Regent Estate-Layelka-Bapujinagar-Na...	10	700 092, 700 032	Jadavpur	22.489833	88.370694
100	100	Garia (Ramgarh-Naktala-Laxmi Narayan Colony)	10	700 047	Tollyganj	22.473833	88.371694
99	99	Jadavpur (Sree Colony), Baghajatin, Garia (Vid...	10	700 092, 700 047, 700 086	Jadavpur	22.481833	88.371694
98	98	Ranikuthi, Netaji Nagar (Gandhi Colony-Pallisr...	10	700 040	Tollyganj	22.481833	88.359694
97	97	Ashok Nagar, Kudghat, Tollygunge Club, Regent ...	10	700 040	Tollyganj	22.487833	88.348694
95	95	Regent Park (Tilak Nagar-Azadgarh-Aswini Nagar...	10	700 095, 700 040	Tollyganj	22.492833	88.361694
92	92	Dhakuria (Babu Bagan-Selimpur-Teli Para-Tanu P...	10	700 031, 70032	Kasba	22.499833	88.369694
93	93	Dhakuria (Dakshinapan), Jodhpur Park, Lake Gar...	10	700 068, 700 045	Rashbehari	22.504833	88.363694
91	91	Kasba (Rathtala-Bosepukur), Dhakuria (Kalupara...	10	700 042, 700 068, 700 107	Kasba	22.516222	88.378694
89	89	Tollygunge (Charu Market-Swiss Park)	10	700 033	Rashbehari	22.505222	88.347694
81	81	New Alipore, Tollygunj Circular Road	10	700 053	Rashbehari	22.504500	88.335611
94	94	Tollygunge (Royal Calcutta Golf Club-Rajendra ...	10	700 033	Tollyganj	22.497833	88.351694
110	110	Garia (Baishnabghata Patuli Township-Kanungo P...	11	700 094, 700 084	Jadavpur	22.473833	88.382694
101	101	Baghajatin (Ajanta Park), Garia (Phool Bagan-G...	11	700 084, 700 094, 700 086	Jadavpur	22.476833	88.381694
102	102	Jadavpur (KPC Medical College and Hospital-Ram...	11	700 032, 700 092	Jadavpur	22.486833	88.376694
113	113	Bansdroni (Jaysree Park-Kalitala)	11	700 047	Tollyganj	22.472833	88.354694
112	112	Bansdroni (Rania-Roy Nagar)	11	700 047	Tollyganj	22.467833	88.365694
111	111	Garia–Brahmapur–Kamdahari-Boral	11	700 084, 700 096, 700 154	Tollyganj	22.462833	88.370694
114	114	Bansdroni (Purba Putiari-Sahapara)	11	700 093	Tollyganj	22.476833	88.348806
109	109	Haltu (Kalikapur), Santoshpur (Borakhola-Nanda...	12	700 094, 700 099	Jadavpur	22.481833	88.400694
107	107	Tiljala (Panchanna Gram), Kasba (Purbapara-Raj...	12	700 046	Kasba	22.514833	88.397694
106	106	Haltu (Nandi Bagan-Kayasthapara-Ramlal Bazar-S...	12	700 078	Jadavpur	22.508833	88.387694
105	105	Haltu (Baidya Para-Jadavgarh-Ashutosh Colony-S...	12	700 078	Jadavpur	22.506833	88.387694
104	104	Garfa (Bhattacharjee Para-Sen Para), Haltu (Sh...	12	700 075, 700 099	Jadavpur	22.498833	88.383694
103	103	Santoshpur (Santoshpur Lake-Bidhan Colony-Mode...	12	700 075	Jadavpur	22.491833	88.383694
108	108	VIP Nagar (Gouranga Pally-Matongini Colony), U...	12	700 039	Kasba	22.522133	88.409694
123	123	Barisha	13	700 008	Behala Purba	22.481833	88.316694
122	122	Behala (Sukanta Pally-Sodpur-Kazipara), Haride...	13	700 082	Behala Purba	22.483222	88.328389
120	120	Behala (James Long Sarani-Bliss Park-Behala Ga...	13	700 034	Behala Purba	22.496833	88.319806
119	119	Behala (James Long Sarani-Sahapur-Railway Colony)	13	700 038	Behala Paschim	22.503833	88.322806
121	121	Behala (Jadu Nagar Colony-Jayasree Colony-Mond...	13	700 034	Behala Purba	22.489222	88.327389
117	117	Tollygunge Circular Road (Chandubabur Jheel-Bu...	13	700 034	Behala Purba	22.501833	88.337806
116	116	Tollygunge Circular Road (Sirity-Senhati Colony)	13	700 034	Behala Purba	22.496833	88.336806
115	115	Paschim Putiary-Kudghat-Karunamoyee	13	700 041	Behala Purba	22.481833	88.341806
118	118	Tollygunge Circular Road (Sahapur)-New Alipore	13	700 038, 700 053	Behala Paschim	22.506833	88.331806
132	132	Behala (Naskarpur-Bara Bagan-Pathakpara)	14	700 060, 700 034	Behala Paschim	22.507865	88.314694
127	127	Sarsuna (Sarsuna satellite township-Shakuntala...	14	700 061, 700 063	Behala Paschim	22.478235	88.288694
128	128	Behala (Ramnarayan Government Colony-Dhamarajt...	14	700 061, 700 063	Behala Paschim	22.488345	88.297694
129	129	Behala (Adarsha Nagar-BG Press Colony-Sreema P...	14	700 060, 700 063	Behala Paschim	22.496735	88.297694
130	130	Behala (Manton Super Market-Bakshi Bagan-Uniqu...	14	700 034,	Behala Paschim	22.498125	88.310694
131	131	Behala (Parnasree Pally)	14	700 060	Behala Paschim	22.508135	88.301694
136	136	Garden Reach (Metiabruz)	15	700 018	Metiaburuz	22.539806	88.281556
135	135	Garden Reach (Bichali Ghat-Mudiali)	15	700 024	Kolkata Port	22.546806	88.284556
137	137	Garden Reach (Metiabruz-Lichu Bagan)	15	700 024 700 044	Metiaburuz	22.548806	88.273556
134	134	Garden Reach (Ramnagar)	15	700 024	Kolkata Port	22.545111	88.291556
141	141	Badartala, Rajabagan	15	700 018, 700 044	Metiaburuz	22.554417	88.254556
140	140	Metiabruz (Kanthalberia-Mullickpara)	15	700 018, 700 044	Metiaburuz	22.546806	88.261556
138	138	Metiabruz (Panchpara-Kashyappara-Jabarhat)	15	700 018	Metiaburuz	22.548806	88.268556
133	133	Garden Reach (Akshay Kanan)	15	Series([], )	Kolkata Port	22.538111	88.286556
139	139	Metiabruz (Bartala-Karbala)	15	700 018, 700 044	Metiaburuz	22.539806	88.267556
142	142	Joka	16	Series([], )	Behala Purba	22.464889	88.331542
126	126	Sarsuna, Paschim Barisha	16	700 008, 700 061, 700 063	Behala Paschim	22.473275	88.297694
124	124	Barisha, Thakurpukur	16	700 008, 700 063	Behala Purba	22.468675	88.316694
143	143	Joka	16	Series([], )	Behala Purba	22.456589	88.321242
125	125	Paschim Barisha, Thakurpukur	16	700 008, 700 063	Behala Paschim	22.473275	88.301694
144	144	Joka	16	Series([], )	Behala Purba	22.456789	88.301242
Populating Missing Data with dummy values
After observing the dataframe data, We have identified 3 Wards (Jika,Garden Reach (Akshay Kanan),Paikpara) which do not contain any postalcode information. We have manually assigned values for those.

In [10]:
#Data Cleaning 
df_kolkata.loc[df_kolkata["ward"] == 'Joka',"postalcode"] = '700 104'
df_kolkata.loc[df_kolkata["ward"] == 'Garden Reach (Akshay Kanan)',"postalcode"] = '700 024'
df_kolkata.loc[df_kolkata["ward"] == 'Paikpara',"postalcode"] = '700 002, 700 037'

#df_kolkata['longitude'] = df_kolkata['longitude'].replace("N","")
df_kolkata.head()
Out[10]:
ward_no	ward	borough	postalcode	locality	latitude	longitude
1	1	Cossipore	1	700 003	Kashipur-Belgachhia	22.617889	88.370556
2	2	Sinthee (Ramlila Bagan-Biswanath Colony-Roypar...	1	700 050	Kashipur-Belgachhia	22.628056	88.384444
3	3	Belgachia, Duttabagan	1	700 037	Kashipur-Belgachhia	22.604444	88.383333
4	4	Paikpara	1	700 002, 700 037	Kashipur-Belgachhia	22.613056	88.379444
5	5	Tala	1	700 002	Kashipur-Belgachhia	22.608889	88.379694
Projection of Data Points on Folium Map
Here we see map of kolkata with blue circles pointing each wards. Folium CircleMaker method has been used to create these circles by passing latitude and longitude data from above data frame. Folium Popup method has been used to create pop-ups with Ward name and neighborhood/locality name data.This popup will be visible whenever an user will click on these blue circles

In [11]:
map_kolkata = folium.Map(width=1000,height=500,location=[22.568889, 88.346167], zoom_start=11)

for lat, lng, ward, neighborhood in zip( df_kolkata['latitude'],df_kolkata['longitude'], df_kolkata['ward'],df_kolkata['locality']):
    label = '{}| {}'.format(ward,neighborhood)
    label = folium.Popup(label, parse_html=True)
    folium.CircleMarker(
        [lat, lng],
        radius=5,
        popup=label,
        color='blue',
        fill=True,
        fill_color='#3186cc',
        fill_opacity=0.7,
        parse_html=False).add_to(map_kolkata)  
map_kolkata.add_child(folium.LatLngPopup())
map_kolkata
Out[11]:
In [12]:
#df_kolkata.reset_index(inplace=True)
latitude = '22.532889'
longitude = '88.343472'
search_query = ''
radius = 1000
LIMIT = 50

#df_kolkata.iloc[0]
Preparing url
Preparing url to call Explore Api , provided my Foursquare. We will use "explore" api to collect nearby venues from each ward.

In [13]:
url = 'https://api.foursquare.com/v2/venues/explore?&client_id={}&client_secret={}&v={}&ll={},{}&radius={}&limit={}'.format(
    CLIENT_ID, 
    CLIENT_SECRET, 
    VERSION, 
    latitude, 
    longitude, 
    radius, 
    LIMIT)
url
Out[13]:
'https://api.foursquare.com/v2/venues/explore?&client_id=FWTZSMHN2LO3ASEOMNMJKKROKEJM0BWXS34XGRY4TSCEBQ4Y&client_secret=M4GZJY12ZXNG4KRAZIQQZVNFPIINOLHTPLIG1QRKTRS3IWKJ&v=20190605&ll=22.532889,88.343472&radius=1000&limit=50'
In [ ]:

In [14]:
results = requests.get(url).json()
In [15]:
# function that extracts the category of the venue
def get_category_type(row):
    try:
        categories_list = row['categories']
    except:
        categories_list = row['venue.categories']
        
    if len(categories_list) == 0:
        return None
    else:
        return categories_list[0]['name']
In [16]:
venues = results['response']['groups'][0]['items']
Example Data Frame
This is how an example data frame may look. There are numerious fileds returned by foursquare but we will only consider venue-name, venue-categories,venue-location-lat,venue-location-lang

In [17]:
nearby_venues = json_normalize(venues) # flatten JSON

# filter columns
filtered_columns = ['venue.name', 'venue.categories', 'venue.location.lat', 'venue.location.lng']
nearby_venues =nearby_venues.loc[:, filtered_columns]

# filter the category for each row
nearby_venues['venue.categories'] = nearby_venues.apply(get_category_type, axis=1)

# clean columns
nearby_venues.columns = [col.split(".")[-1] for col in nearby_venues.columns]

nearby_venues.head(10)
Out[17]:
name	categories	lat	lng
0	Balaram Mullick & Radharaman Mullick	Indian Sweet Shop	22.533097	88.347082
1	Balwant Singh's Eating House	Dhaba	22.537714	88.344220
2	Balwant Singh's Snack Corner	Fast Food Restaurant	22.537709	88.344228
3	Tyre Patty	Café	22.538048	88.349169
4	Privy Ultra Lounge	Nightclub	22.538145	88.351121
5	The Bikers Cafe	American Restaurant	22.537719	88.348993
6	McDonald's	Fast Food Restaurant	22.536206	88.346353
7	Chai Break	Tea Room	22.539382	88.347070
8	Cafe Coffee Day	Café	22.525476	88.345297
9	Harish Park	Park	22.530499	88.343569
In [18]:
print('{} venues were returned by Foursquare.'.format(nearby_venues.shape[0]))
13 venues were returned by Foursquare.
In [19]:
def getNearbyVenues(names, latitudes, longitudes, radius=500):
    
    venues_list=[]
    for name, lat, lng in zip(names, latitudes, longitudes):
        print('{}|lat:{},lang:{}'.format(name,lat,lng))
            
        # create the API request URL
        url = 'https://api.foursquare.com/v2/venues/explore?&client_id={}&client_secret={}&v={}&ll={},{}&radius={}&limit={}'.format(
            CLIENT_ID, 
            CLIENT_SECRET, 
            VERSION, 
            lat, 
            lng, 
            radius, 
            LIMIT)
            
        # make the GET request
        results = requests.get(url).json()["response"]['groups'][0]['items']
        
        # return only relevant information for each nearby venue
        venues_list.append([(
            name, 
            lat, 
            lng, 
            v['venue']['name'], 
            v['venue']['location']['lat'], 
            v['venue']['location']['lng'],  
            v['venue']['categories'][0]['name']) for v in results])

    nearby_venues = pd.DataFrame([item for venue_list in venues_list for item in venue_list])
    nearby_venues.columns = ['Neighborhood', 
                  'Neighborhood Latitude', 
                  'Neighborhood Longitude', 
                  'Venue', 
                  'Venue Latitude', 
                  'Venue Longitude', 
                  'Venue Category']
    
    return(nearby_venues)
All venues
We have prepared getNearbyVenue() method to pull and populate a dataframe with all venues for each wards (venues available in 1000 meter radius.

In [20]:
kolkata_venues = getNearbyVenues(names=df_kolkata['ward'],
                                   latitudes=df_kolkata['latitude'],
                                   longitudes=df_kolkata['longitude']
                                  )
Cossipore|lat:22.617889,lang:88.370556
Sinthee (Ramlila Bagan-Biswanath Colony-Roypar...|lat:22.628056,lang:88.384444
Belgachia, Duttabagan|lat:22.604444,lang:88.383333
Paikpara|lat:22.613056,lang:88.379444
Tala|lat:22.608889,lang:88.379694
Chitpur, Cossipore|lat:22.610863,lang:88.371213
Bagbazar|lat:22.603567,lang:88.365806
Bagbazar, Shyampukur|lat:22.601806,lang:88.3665
Shobhabazar, Kumortuli|lat:22.595889,lang:88.365306
Shyambazar, Shobhabazar, Shyampukur|lat:22.597889,lang:88.364326
Shyambazar, Burtolla, Hatibagan|lat:22.598806,lang:88.373611
Shyambazar (Fariapukur)|lat:22.596806,lang:88.376694
Ultadanga (Daspara-Muchi Bazar-Telenga Bagan-S...|lat:22.594167,lang:88.385889
Ultadanga (Murari Pukur), Bagmari|lat:22.589278,lang:88.385556
Maniktala (Bangiya Sahitya Parishad-Halsi Baga...|lat:22.590278,lang:88.376556
Maniktala (Bangiya Sahitya Parishad-Goa Bagan)|lat:22.591278,lang:88.371361
Shobhabazar, Darjipara|lat:22.595378,lang:88.365556
Shobhabazar|lat:22.593667,lang:88.362861
Ahiritola and Beniatola|lat:22.595667,lang:88.357667
Shobhabazar, Ahiritola|lat:22.593556,lang:88.354667
Jorabagan|lat:22.592167,lang:88.352472
Posta|lat:22.586861,lang:88.351667
Posta, Jorasanko|lat:22.584667,lang:88.356667
Pathuriaghata|lat:22.588472,lang:88.356361
Rambagan, Girish Park, Jorasanko, Simla|lat:22.587761,lang:88.361251
Ramdulal Sarkar Street and Hedua Park|lat:22.58725,lang:88.365028
Maniktala|lat:22.58525,lang:88.372333
Maniktala, Garpar, Rajabazar|lat:22.58025,lang:88.375833
Narkeldanga|lat:22.57925,lang:88.379833
Narkeldanga, Phoolbagan, Kankurgachi|lat:22.57625,lang:88.387528
Kankurgachi, Phoolbagan (Kadapara)|lat:22.579861,lang:88.388917
Kankurgachi, Bagmari, Ultadanga (Murari Pukur-...|lat:22.582861,lang:88.391917
Phoolbagan (Subhas Sarovar), Beliaghata (Kulia)|lat:22.564861,lang:88.399306
Beliaghata (Ganguly Bagan-Uria Bagan-Kulia)|lat:22.564861,lang:88.389306
Beliaghata (Kundu Bagan-Kulia), Phoolbagan|lat:22.567861,lang:88.384306
Beliaghata (Barafkal), Sealdah, Rajabazar|lat:22.566861,lang:88.376972
Sealdah (Baithakkhana), Rajabazar|lat:22.574861,lang:88.369861
Rajabazar, Amherst Street|lat:22.579167,lang:88.370861
Marcus Square, College Street, Simla|lat:22.579667,lang:88.362861
College Street, College Square, Patuatola, Nar...|lat:22.575461,lang:88.364361
Jorasanko|lat:22.582278,lang:88.359167
Burrabazar|lat:22.580313,lang:88.352673
Burrabazar (Mechhua), Kolutola|lat:22.576889,lang:88.359167
Burrabazar (Mechhua), Tiretta Bazaar, Colootol...|lat:22.574889,lang:88.357361
Esplanade West, Eden Gardens, Babughat, Millen...|lat:22.568889,lang:88.346167
Chowringhee, Esplanade East, Dharmatala, Janba...|lat:22.56725,lang:88.350722
Bowbazar (Chandni Chowk), Dharmatala|lat:22.56825,lang:88.359611
Bowbazar|lat:22.568249,lang:88.361389
Bowbazar, Sealdah (Baithakkhana)|lat:22.568235,lang:88.367611
Bowbazar (Lebutala), Taltala, Moulali, Sealdah|lat:22.5659,lang:88.3633
Bowbazar, Taltala|lat:22.565245,lang:88.362611
Taltala (Collin Street-Marquis Street), Janbazar|lat:22.558245,lang:88.356611
Taltala, Moulali|lat:22.558245,lang:88.361611
Entally|lat:22.558685,lang:88.368611
Sealdah, Entally|lat:22.554245,lang:88.372811
Entally, Tangra (Seal Lane)|lat:22.55525,lang:88.378611
Tangra (Munshi Bazar-Canal South Road-Metropol...|lat:22.559333,lang:88.389611
Tangra (Seal Lane), Dhapa (Mathpukur), East Ko...|lat:22.543333,lang:88.39725
Park Circus (Beniapukur-Gobra), Tangra (Seal L...|lat:22.545333,lang:88.377125
Park Circus (Beniapukur)|lat:22.547333,lang:88.369325
Park Circus (Nonapukur-Beniapukur), Park Stree...|lat:22.549639,lang:88.35925
Taltala (Ripon Street-Alimuddin Street), Moulali|lat:22.554839,lang:88.360625
Chowringhee, Taltala (Ripon Street-Royd Street...|lat:22.546639,lang:88.352444
Park Street (Mullick Bazar), Park Circus (Beni...|lat:22.541217,lang:88.364333
Ballygunge (Ballygunge Park), Park Circus (Gob...|lat:22.531667,lang:88.368444
Tangra (Chinatown), Topsia, Science City, Foru...|lat:22.531861,lang:88.385444
Tiljala (Kata Pukur-Bediadanga), Kasba (Natore...|lat:22.523889,lang:88.376444
Ballygunge (Ballygunge Place-Ekdalia-Ballygung...|lat:22.521889,lang:88.368472
Ballygunge, Beck Bagan|lat:22.529889,lang:88.359472
Bhowanipore (Sreepally-Jadubabur Bazar)|lat:22.537889,lang:88.350472
Bhowanipore|lat:22.532889,lang:88.343472
Bhowanipore (Chakraberia-Paddapukur-Bakulbagan)|lat:22.528583,lang:88.348472
Bhowanipore (Patuapara), Kalighat|lat:22.527889,lang:88.343472
Alipore|lat:22.525889,lang:88.330472
Hastings, Watgunge|lat:22.546944,lang:88.323472
Watgunge, Kidderpore (Andaman Dock)|lat:22.541944,lang:88.317861
Kidderpore (Dr. Sudhir Bose Road)|lat:22.536944,lang:88.323861
Ekbalpur, Mominpur|lat:22.528944,lang:88.324235
Kidderpore (Babu Bazar), Mominpur, Majherhat, ...|lat:22.53325,lang:88.310611
Kidderpore (Andaman Dock), Garden Reach (BNR C...|lat:22.540325,lang:88.300161
New Alipore, Tollygunj Circular Road|lat:22.5045,lang:88.335611
Chetla|lat:22.517345,lang:88.335611
Kalighat|lat:22.521455,lang:88.342611
Kalighat, Manoharpukur|lat:22.518435,lang:88.349417
Ballygunge (Deshapriya Park)|lat:22.521141,lang:88.356306
Ballygunge (Lake Terrace-Keyatala), Gariahat (...|lat:22.518917,lang:88.364306
Kalighat (Lake Market-Lake Range-Mudiali)|lat:22.513917,lang:88.350694
Kalighat (Sahanagar-Lalpara)|lat:22.514917,lang:88.343694
Tollygunge (Charu Market-Swiss Park)|lat:22.505222,lang:88.347694
Ballygunge (Lake Terrace), Rabindra Sarobar, D...|lat:22.514222,lang:88.366694
Kasba (Rathtala-Bosepukur), Dhakuria (Kalupara...|lat:22.516222,lang:88.378694
Dhakuria (Babu Bagan-Selimpur-Teli Para-Tanu P...|lat:22.499833,lang:88.369694
Dhakuria (Dakshinapan), Jodhpur Park, Lake Gar...|lat:22.504833,lang:88.363694
Tollygunge (Royal Calcutta Golf Club-Rajendra ...|lat:22.497833,lang:88.351694
Regent Park (Tilak Nagar-Azadgarh-Aswini Nagar...|lat:22.492833,lang:88.361694
Jadavpur (Regent Estate-Layelka-Bapujinagar-Na...|lat:22.489833,lang:88.370694
Ashok Nagar, Kudghat, Tollygunge Club, Regent ...|lat:22.487833,lang:88.348694
Ranikuthi, Netaji Nagar (Gandhi Colony-Pallisr...|lat:22.481833,lang:88.359694
Jadavpur (Sree Colony), Baghajatin, Garia (Vid...|lat:22.481833,lang:88.371694
Garia (Ramgarh-Naktala-Laxmi Narayan Colony)|lat:22.473833,lang:88.371694
Baghajatin (Ajanta Park), Garia (Phool Bagan-G...|lat:22.476833,lang:88.381694
Jadavpur (KPC Medical College and Hospital-Ram...|lat:22.486833,lang:88.376694
Santoshpur (Santoshpur Lake-Bidhan Colony-Mode...|lat:22.491833,lang:88.383694
Garfa (Bhattacharjee Para-Sen Para), Haltu (Sh...|lat:22.498833,lang:88.383694
Haltu (Baidya Para-Jadavgarh-Ashutosh Colony-S...|lat:22.506833,lang:88.387694
Haltu (Nandi Bagan-Kayasthapara-Ramlal Bazar-S...|lat:22.508833,lang:88.387694
Tiljala (Panchanna Gram), Kasba (Purbapara-Raj...|lat:22.514833,lang:88.397694
VIP Nagar (Gouranga Pally-Matongini Colony), U...|lat:22.522133,lang:88.409694
Haltu (Kalikapur), Santoshpur (Borakhola-Nanda...|lat:22.481833,lang:88.400694
Garia (Baishnabghata Patuli Township-Kanungo P...|lat:22.473833,lang:88.382694
Garia–Brahmapur–Kamdahari-Boral|lat:22.462833,lang:88.370694
Bansdroni (Rania-Roy Nagar)|lat:22.467833,lang:88.365694
Bansdroni (Jaysree Park-Kalitala)|lat:22.472833,lang:88.354694
Bansdroni (Purba Putiari-Sahapara)|lat:22.476833,lang:88.348806
Paschim Putiary-Kudghat-Karunamoyee|lat:22.481833,lang:88.341806
Tollygunge Circular Road (Sirity-Senhati Colony)|lat:22.496833,lang:88.336806
Tollygunge Circular Road (Chandubabur Jheel-Bu...|lat:22.501833,lang:88.337806
Tollygunge Circular Road (Sahapur)-New Alipore|lat:22.506833,lang:88.331806
Behala (James Long Sarani-Sahapur-Railway Colony)|lat:22.503833,lang:88.322806
Behala (James Long Sarani-Bliss Park-Behala Ga...|lat:22.496833,lang:88.319806
Behala (Jadu Nagar Colony-Jayasree Colony-Mond...|lat:22.489222,lang:88.327389
Behala (Sukanta Pally-Sodpur-Kazipara), Haride...|lat:22.483222,lang:88.328389
Barisha|lat:22.481833,lang:88.316694
Barisha, Thakurpukur|lat:22.468675,lang:88.316694
Paschim Barisha, Thakurpukur|lat:22.473275,lang:88.301694
Sarsuna, Paschim Barisha|lat:22.473275,lang:88.297694
Sarsuna (Sarsuna satellite township-Shakuntala...|lat:22.478235,lang:88.288694
Behala (Ramnarayan Government Colony-Dhamarajt...|lat:22.488345,lang:88.297694
Behala (Adarsha Nagar-BG Press Colony-Sreema P...|lat:22.496735,lang:88.297694
Behala (Manton Super Market-Bakshi Bagan-Uniqu...|lat:22.498125,lang:88.310694
Behala (Parnasree Pally)|lat:22.508135,lang:88.301694
Behala (Naskarpur-Bara Bagan-Pathakpara)|lat:22.507865,lang:88.314694
Garden Reach (Akshay Kanan)|lat:22.538111,lang:88.286556
Garden Reach (Ramnagar)|lat:22.545111,lang:88.291556
Garden Reach (Bichali Ghat-Mudiali)|lat:22.546806,lang:88.284556
Garden Reach (Metiabruz)|lat:22.539806,lang:88.281556
Garden Reach (Metiabruz-Lichu Bagan)|lat:22.548806,lang:88.273556
Metiabruz (Panchpara-Kashyappara-Jabarhat)|lat:22.548806,lang:88.268556
Metiabruz (Bartala-Karbala)|lat:22.539806,lang:88.267556
Metiabruz (Kanthalberia-Mullickpara)|lat:22.546806,lang:88.261556
Badartala, Rajabagan|lat:22.554417,lang:88.254556
Joka|lat:22.464889,lang:88.331542
Joka|lat:22.456589,lang:88.321242
Joka|lat:22.456789,lang:88.301242
Grouping venues using neighborhood and generating counts.

In [21]:
print(kolkata_venues.shape)
kolkata_venues.groupby('Neighborhood').count()
(549, 7)
Out[21]:
Neighborhood Latitude	Neighborhood Longitude	Venue	Venue Latitude	Venue Longitude	Venue Category
Neighborhood						
Ahiritola and Beniatola	1	1	1	1	1	1
Alipore	7	7	7	7	7	7
Ashok Nagar, Kudghat, Tollygunge Club, Regent ...	3	3	3	3	3	3
Badartala, Rajabagan	1	1	1	1	1	1
Bagbazar	6	6	6	6	6	6
Bagbazar, Shyampukur	4	4	4	4	4	4
Baghajatin (Ajanta Park), Garia (Phool Bagan-G...	1	1	1	1	1	1
Ballygunge (Ballygunge Park), Park Circus (Gob...	10	10	10	10	10	10
Ballygunge (Ballygunge Place-Ekdalia-Ballygung...	7	7	7	7	7	7
Ballygunge (Deshapriya Park)	6	6	6	6	6	6
Ballygunge (Lake Terrace), Rabindra Sarobar, D...	5	5	5	5	5	5
Ballygunge (Lake Terrace-Keyatala), Gariahat (...	21	21	21	21	21	21
Ballygunge, Beck Bagan	4	4	4	4	4	4
Bansdroni (Jaysree Park-Kalitala)	1	1	1	1	1	1
Bansdroni (Rania-Roy Nagar)	1	1	1	1	1	1
Barisha, Thakurpukur	1	1	1	1	1	1
Behala (Jadu Nagar Colony-Jayasree Colony-Mond...	1	1	1	1	1	1
Behala (James Long Sarani-Bliss Park-Behala Ga...	4	4	4	4	4	4
Behala (James Long Sarani-Sahapur-Railway Colony)	4	4	4	4	4	4
Behala (Manton Super Market-Bakshi Bagan-Uniqu...	1	1	1	1	1	1
Behala (Naskarpur-Bara Bagan-Pathakpara)	1	1	1	1	1	1
Behala (Parnasree Pally)	2	2	2	2	2	2
Belgachia, Duttabagan	2	2	2	2	2	2
Beliaghata (Barafkal), Sealdah, Rajabazar	1	1	1	1	1	1
Beliaghata (Ganguly Bagan-Uria Bagan-Kulia)	4	4	4	4	4	4
Bhowanipore	4	4	4	4	4	4
Bhowanipore (Chakraberia-Paddapukur-Bakulbagan)	5	5	5	5	5	5
Bhowanipore (Patuapara), Kalighat	5	5	5	5	5	5
Bhowanipore (Sreepally-Jadubabur Bazar)	22	22	22	22	22	22
Bowbazar	1	1	1	1	1	1
Bowbazar (Chandni Chowk), Dharmatala	4	4	4	4	4	4
Bowbazar (Lebutala), Taltala, Moulali, Sealdah	3	3	3	3	3	3
Bowbazar, Sealdah (Baithakkhana)	4	4	4	4	4	4
Bowbazar, Taltala	3	3	3	3	3	3
Burrabazar	5	5	5	5	5	5
Burrabazar (Mechhua), Kolutola	7	7	7	7	7	7
Burrabazar (Mechhua), Tiretta Bazaar, Colootol...	4	4	4	4	4	4
Chetla	4	4	4	4	4	4
Chitpur, Cossipore	1	1	1	1	1	1
Chowringhee, Esplanade East, Dharmatala, Janba...	9	9	9	9	9	9
Chowringhee, Taltala (Ripon Street-Royd Street...	26	26	26	26	26	26
College Street, College Square, Patuatola, Nar...	7	7	7	7	7	7
Dhakuria (Babu Bagan-Selimpur-Teli Para-Tanu P...	1	1	1	1	1	1
Dhakuria (Dakshinapan), Jodhpur Park, Lake Gar...	20	20	20	20	20	20
Ekbalpur, Mominpur	3	3	3	3	3	3
Entally	1	1	1	1	1	1
Esplanade West, Eden Gardens, Babughat, Millen...	4	4	4	4	4	4
Garden Reach (Bichali Ghat-Mudiali)	1	1	1	1	1	1
Garden Reach (Ramnagar)	1	1	1	1	1	1
Garfa (Bhattacharjee Para-Sen Para), Haltu (Sh...	2	2	2	2	2	2
Garia (Baishnabghata Patuli Township-Kanungo P...	5	5	5	5	5	5
Garia (Ramgarh-Naktala-Laxmi Narayan Colony)	1	1	1	1	1	1
Haltu (Baidya Para-Jadavgarh-Ashutosh Colony-S...	2	2	2	2	2	2
Haltu (Nandi Bagan-Kayasthapara-Ramlal Bazar-S...	1	1	1	1	1	1
Jadavpur (Regent Estate-Layelka-Bapujinagar-Na...	3	3	3	3	3	3
Jadavpur (Sree Colony), Baghajatin, Garia (Vid...	4	4	4	4	4	4
Joka	5	5	5	5	5	5
Jorabagan	2	2	2	2	2	2
Jorasanko	4	4	4	4	4	4
Kalighat	1	1	1	1	1	1
Kalighat (Lake Market-Lake Range-Mudiali)	12	12	12	12	12	12
Kalighat (Sahanagar-Lalpara)	4	4	4	4	4	4
Kalighat, Manoharpukur	11	11	11	11	11	11
Kankurgachi, Bagmari, Ultadanga (Murari Pukur-...	7	7	7	7	7	7
Kankurgachi, Phoolbagan (Kadapara)	8	8	8	8	8	8
Kasba (Rathtala-Bosepukur), Dhakuria (Kalupara...	5	5	5	5	5	5
Kidderpore (Andaman Dock), Garden Reach (BNR C...	3	3	3	3	3	3
Kidderpore (Dr. Sudhir Bose Road)	8	8	8	8	8	8
Maniktala	4	4	4	4	4	4
Maniktala (Bangiya Sahitya Parishad-Goa Bagan)	7	7	7	7	7	7
Maniktala (Bangiya Sahitya Parishad-Halsi Baga...	4	4	4	4	4	4
Marcus Square, College Street, Simla	6	6	6	6	6	6
Metiabruz (Bartala-Karbala)	1	1	1	1	1	1
Metiabruz (Kanthalberia-Mullickpara)	2	2	2	2	2	2
Metiabruz (Panchpara-Kashyappara-Jabarhat)	1	1	1	1	1	1
Narkeldanga	1	1	1	1	1	1
Narkeldanga, Phoolbagan, Kankurgachi	8	8	8	8	8	8
New Alipore, Tollygunj Circular Road	3	3	3	3	3	3
Paikpara	2	2	2	2	2	2
Park Circus (Beniapukur)	1	1	1	1	1	1
Park Circus (Nonapukur-Beniapukur), Park Stree...	5	5	5	5	5	5
Park Street (Mullick Bazar), Park Circus (Beni...	20	20	20	20	20	20
Paschim Barisha, Thakurpukur	3	3	3	3	3	3
Paschim Putiary-Kudghat-Karunamoyee	4	4	4	4	4	4
Pathuriaghata	4	4	4	4	4	4
Phoolbagan (Subhas Sarovar), Beliaghata (Kulia)	2	2	2	2	2	2
Posta	8	8	8	8	8	8
Posta, Jorasanko	3	3	3	3	3	3
Rajabazar, Amherst Street	4	4	4	4	4	4
Rambagan, Girish Park, Jorasanko, Simla	6	6	6	6	6	6
Ramdulal Sarkar Street and Hedua Park	6	6	6	6	6	6
Ranikuthi, Netaji Nagar (Gandhi Colony-Pallisr...	3	3	3	3	3	3
Regent Park (Tilak Nagar-Azadgarh-Aswini Nagar...	8	8	8	8	8	8
Santoshpur (Santoshpur Lake-Bidhan Colony-Mode...	6	6	6	6	6	6
Sarsuna (Sarsuna satellite township-Shakuntala...	2	2	2	2	2	2
Sarsuna, Paschim Barisha	1	1	1	1	1	1
Sealdah (Baithakkhana), Rajabazar	5	5	5	5	5	5
Sealdah, Entally	3	3	3	3	3	3
Shobhabazar	5	5	5	5	5	5
Shobhabazar, Ahiritola	2	2	2	2	2	2
Shobhabazar, Darjipara	4	4	4	4	4	4
Shobhabazar, Kumortuli	4	4	4	4	4	4
Shyambazar (Fariapukur)	4	4	4	4	4	4
Shyambazar, Burtolla, Hatibagan	5	5	5	5	5	5
Shyambazar, Shobhabazar, Shyampukur	5	5	5	5	5	5
Sinthee (Ramlila Bagan-Biswanath Colony-Roypar...	2	2	2	2	2	2
Tala	2	2	2	2	2	2
Taltala (Collin Street-Marquis Street), Janbazar	12	12	12	12	12	12
Taltala (Ripon Street-Alimuddin Street), Moulali	2	2	2	2	2	2
Taltala, Moulali	1	1	1	1	1	1
Tangra (Chinatown), Topsia, Science City, Foru...	1	1	1	1	1	1
Tangra (Munshi Bazar-Canal South Road-Metropol...	1	1	1	1	1	1
Tangra (Seal Lane), Dhapa (Mathpukur), East Ko...	9	9	9	9	9	9
Tiljala (Kata Pukur-Bediadanga), Kasba (Natore...	1	1	1	1	1	1
Tiljala (Panchanna Gram), Kasba (Purbapara-Raj...	8	8	8	8	8	8
Tollygunge (Charu Market-Swiss Park)	4	4	4	4	4	4
Tollygunge (Royal Calcutta Golf Club-Rajendra ...	3	3	3	3	3	3
Tollygunge Circular Road (Sahapur)-New Alipore	3	3	3	3	3	3
Ultadanga (Daspara-Muchi Bazar-Telenga Bagan-S...	2	2	2	2	2	2
Ultadanga (Murari Pukur), Bagmari	3	3	3	3	3	3
Watgunge, Kidderpore (Andaman Dock)	1	1	1	1	1	1
Exploring Unique Data Categories
In [22]:
print('There are {} uniques categories.'.format(len(kolkata_venues['Venue Category'].unique())))
kolkata_venues['Venue Category'].unique()
There are 116 uniques categories.
Out[22]:
array(['Playground', 'Burger Joint', 'Train Station', 'Music Venue',
       'Watch Shop', 'Bank', 'Park', 'Pier', 'River',
       'Chinese Restaurant', 'Neighborhood', 'Metro Station',
       'Indian Sweet Shop', 'Fast Food Restaurant', 'Market',
       'Indian Restaurant', 'Plaza', 'Vegetarian / Vegan Restaurant',
       'Mughlai Restaurant', 'Pizza Place', 'Bus Stop',
       'Dumpling Restaurant', 'Gym', 'ATM', "Men's Store",
       'Clothing Store', 'Café', 'Historic Site', 'Theater',
       'Indie Movie Theater', 'Bengali Restaurant', 'Fried Chicken Joint',
       'Food', 'Boat or Ferry', 'IT Services', 'Candy Store',
       "Women's Store", 'Comfort Food Restaurant', 'Snack Place',
       'History Museum', 'Art Museum', 'Museum', 'Asian Restaurant',
       'Bakery', 'Dessert Shop', 'Department Store', 'Coffee Shop',
       'Electronics Store', 'Dhaba', 'Tea Room', 'Pharmacy', 'Hotel',
       'Platform', 'Movie Theater', 'Tram Station',
       'Paper / Office Supplies Store', 'Bookstore', 'Juice Bar',
       'Breakfast Spot', 'Pool', 'Gujarati Restaurant',
       'South Indian Restaurant', 'Multiplex', 'Flea Market', 'Pub',
       'Restaurant', 'Sandwich Place', 'Beer Garden', 'Shopping Mall',
       'Health & Beauty Service', 'Bus Station', 'Theme Park',
       'Italian Restaurant', 'Hostel', 'Campground', 'Nightclub',
       'Gastropub', 'Mexican Restaurant', 'Performing Arts Venue',
       'Theme Restaurant', 'Tex-Mex Restaurant', 'Irish Pub',
       'Deli / Bodega', 'Sports Club', 'Ice Cream Shop',
       'Bed & Breakfast', 'American Restaurant', 'Furniture / Home Store',
       'Mobile Phone Shop', 'Jewelry Store', 'Awadhi Restaurant',
       'Grocery Store', 'Shoe Store', 'Bridal Shop', 'Athletics & Sports',
       'Harbor / Marina', 'Gift Shop', 'Kerala Restaurant',
       'Arts & Crafts Store', 'Boutique', 'Lounge', 'Falafel Restaurant',
       'Food & Drink Shop', 'Golf Course', 'Pet Store', 'Taxi Stand',
       'Bistro', 'Convenience Store', 'Food Truck', 'Shipping Store',
       'Circus', 'Diner', 'Gym / Fitness Center', 'Trail', 'Tailor Shop',
       'Motorcycle Shop'], dtype=object)
Creating broader categories
This is a very important stepin our reporting. We do not want to get confused by hundreds of different venue categories available in Foursqaure. We have planned to create few bigger/major categories and want to include available categories to Any of these major categories. We have planned to mark these data to belwo major categories.

'Hospital & Medical'
'Fitness & Sports' 'Eatries' 'Transport', 'Plaza' 'Stores' 'Financial Institution' 'River & Waterbody', 'Neighborhood' 'Business' 'Hotel', 'Health & Beauty', 'Hostel', 'Campground', 'Nightclub',

In [27]:
kolkata_venues.loc[kolkata_venues['Venue Category'].isin (['Chinese Restaurant',
 'Indian Sweet Shop',
 'Indian Restaurant',
 'Mughlai Restaurant',
 'Dumpling Restaurant',
 'Café',
 'Bengali Restaurant',
 'Asian Restaurant',
 'Tea Room',
 'Breakfast Spot',
 'South Indian Restaurant',
 'Beer Garden',
 'Italian Restaurant',
 'Gastropub',
 'Irish Pub',
 'American Restaurant',
 'Awadhi Restaurant',
 'Kerala Restaurant',
 'Falafel Restaurant',
 'Food Truck',
 'Burger Joint',
 'Fried Chicken Joint',
 'Snack Place',
 'Restaurant',
 'Bakery',
 'Coffee Shop',
 'Theme Restaurant',
 'Bistro',
 'Fast Food Restaurant',
 'Vegetarian / Vegan Restaurant',
 'Food',
 'Candy Store',
 'Dessert Shop',
 'Pub',
 'Mexican Restaurant',
 'Tex-Mex Restaurant',
 'Ice Cream Shop',
 'Diner',
 'Dhaba',
 'Sandwich Place',
                                                          'Pizza Place','Juice Bar','Lounge',
'Gujarati Restaurant','Food Service','Tibetan Restaurant',
'North Indian Restaurant','Home Service','BBQ Joint','Chaat Place','Comfort Food Restaurant']
),'Venue Category'] = 'Eatries'


kolkata_venues.loc[kolkata_venues['Venue Category'].isin (['Harbor / Marina',
 'Market',
 'IT Services',
 'Business Service',
 'Flea Market',
'Supermarket'
]
),'Venue Category'] = 'Business'

kolkata_venues.loc[kolkata_venues['Venue Category'].isin ([ 'Bank',
 'Insurance Office',
 'ATM'
]
),'Venue Category'] = 'Financial Institution'

kolkata_venues.loc[kolkata_venues['Venue Category'].isin ([ 'Golf Course',
 'Gym',
 'Sports Club',
 'Gym / Fitness Center',
 'Park',
 'Pool',
 'Theme Park',
 'Garden',
 'Athletics & Sports',
 'Yoga Studio',
 'Playground',  
 'Dance Studio',
                                                           'Martial Arts Dojo'
]
),'Venue Category'] = 'Fitness & Sports'

kolkata_venues.loc[kolkata_venues['Venue Category'].isin ([  'Health & Beauty Service'
]
),'Venue Category'] = 'Health & Beauty'

kolkata_venues.loc[kolkata_venues['Venue Category'].isin ([  'Pharmacy'
]
),'Venue Category'] = 'Hospital & Medical'

kolkata_venues.loc[kolkata_venues['Venue Category'].isin ([  'Art Museum',
'Performing Arts Venue',
 'Plaza',
 'Multiplex',
 'Indie Movie Theater',
 'History Museum',
 'Movie Theater',
 'Shopping Mall',
 'Museum',
'Music Venue',
                                                           'Historic Site', 
'Theater','Trail','Circus'

]
),'Venue Category'] = 'Plaza'

kolkata_venues.loc[kolkata_venues['Venue Category'].isin ([   'River',
                                                           'Pier','Lake','Hotel Pool'
]
),'Venue Category'] = 'River & Waterbody'

kolkata_venues.loc[kolkata_venues['Venue Category'].isin ([ 
'Watch Shop',
'Department Store',
'Furniture / Home Store',
'Photography Studio',
'Paper / Office Supplies Store',
 'Jewelry Store',
 "Women's Store",
 'Auto Garage',
 'Tailor Shop',
 'Gift Shop',
 'Arts & Crafts Store',
 'Music Store',
 'Mobile Phone Shop',
 "Men's Store",
 'Print Shop',
 'Electronics Store',
 'Sporting Goods Shop',
 'Clothing Store',
 'Bookstore',
 'Convenience Store',
 'Bagel Shop','Food & Drink Shop','Frozen Yogurt Shop','Grocery Store','Boutique','Optical Shop','Shoe Store', 'Bridal Shop',
       'Pet Store', 'Shipping Store','Motorcycle Shop', 'Deli / Bodega']),'Venue Category'] ='Stores'


kolkata_venues.loc[kolkata_venues['Venue Category'].isin ([ 
'Boat or Ferry',
'Light Rail Station',
 'Platform',
 'Train Station',
 'Metro Station',
 'Bus Stop',
 'Tram Station',
 'Bus Station',
 'Taxi Stand']),'Venue Category'] = 'Transport'
In [28]:
kolkata_venues['Venue Category'].unique()
Out[28]:
array(['Fitness & Sports', 'Eatries', 'Transport', 'Plaza', 'Stores',
       'Financial Institution', 'River & Waterbody', 'Neighborhood',
       'Business', 'Hospital & Medical', 'Hotel', 'Health & Beauty',
       'Hostel', 'Campground', 'Nightclub', 'Bed & Breakfast'],
      dtype=object)
Grouping data baesd upon Ward Name / Neighborhood
In [29]:
print(kolkata_venues.shape)
#kolkata_eatries.groupby('Neighborhood').count()
kolkata_venues_grouped = kolkata_venues.groupby('Neighborhood').count().reset_index()
kolkata_venues_grouped = kolkata_venues_grouped [["Neighborhood","Venue"]]
kolkata_venues_grouped.head()
(549, 7)
Out[29]:
Neighborhood	Venue
0	Ahiritola and Beniatola	1
1	Alipore	7
2	Ashok Nagar, Kudghat, Tollygunge Club, Regent ...	3
3	Badartala, Rajabagan	1
4	Bagbazar	6
Implementing onehot encoding
Here we have used "Venue Category" in get_dummies method and created columns for each venue category type.

In [30]:
# one hot encoding
kolkata_onehot = pd.get_dummies(kolkata_venues[['Venue Category']], prefix="", prefix_sep="")

# add neighborhood column back to dataframe
kolkata_onehot['Neighborhood'] = kolkata_venues['Neighborhood'] 

# move neighborhood column to the first column
fixed_columns = [kolkata_onehot.columns[8]] + list(kolkata_onehot.columns[:8])+ list(kolkata_onehot.columns[9:])
kolkata_onehot = kolkata_onehot[fixed_columns]

kolkata_onehot.head()
Out[30]:
Hostel	Bed & Breakfast	Business	Campground	Eatries	Financial Institution	Fitness & Sports	Health & Beauty	Hospital & Medical	Hotel	Neighborhood	Nightclub	Plaza	River & Waterbody	Stores	Transport
0	0	0	0	0	0	0	1	0	0	0	Sinthee (Ramlila Bagan-Biswanath Colony-Roypar...	0	0	0	0	0
1	0	0	0	0	1	0	0	0	0	0	Sinthee (Ramlila Bagan-Biswanath Colony-Roypar...	0	0	0	0	0
2	0	0	0	0	0	0	0	0	0	0	Belgachia, Duttabagan	0	0	0	0	1
3	0	0	0	0	0	0	0	0	0	0	Belgachia, Duttabagan	0	0	0	0	1
4	0	0	0	0	0	0	1	0	0	0	Paikpara	0	0	0	0	0
The data frame has been grouped again with neighborhood and Mean() calculated

In [34]:
kolkata_grouped = kolkata_onehot.groupby('Neighborhood').mean().reset_index()
kolkata_grouped.head()
Out[34]:
Neighborhood	Hostel	Bed & Breakfast	Business	Campground	Eatries	Financial Institution	Fitness & Sports	Health & Beauty	Hospital & Medical	Hotel	Nightclub	Plaza	River & Waterbody	Stores	Transport
0	Ahiritola and Beniatola	0.0	0.0	0.0	0.0	1.000000	0.000000	0.000000	0.0	0.0	0.000000	0.0	0.0	0.000000	0.000000	0.0
1	Alipore	0.0	0.0	0.0	0.0	0.857143	0.000000	0.000000	0.0	0.0	0.142857	0.0	0.0	0.000000	0.000000	0.0
2	Ashok Nagar, Kudghat, Tollygunge Club, Regent ...	0.0	0.0	0.0	0.0	0.666667	0.000000	0.000000	0.0	0.0	0.000000	0.0	0.0	0.000000	0.333333	0.0
3	Badartala, Rajabagan	0.0	0.0	0.0	0.0	0.000000	1.000000	0.000000	0.0	0.0	0.000000	0.0	0.0	0.000000	0.000000	0.0
4	Bagbazar	0.0	0.0	0.0	0.0	0.166667	0.166667	0.166667	0.0	0.0	0.000000	0.0	0.0	0.333333	0.000000	0.0
In [35]:
def return_most_common_venues(row, num_top_venues):
    row_categories = row.iloc[1:]
    row_categories_sorted = row_categories.sort_values(ascending=False)
    
    return row_categories_sorted.index.values[0:num_top_venues]
Then I created a table which shows list of top 10 venue category for each neighbourhood in below table.

In [36]:
num_top_venues = 10

indicators = ['st', 'nd', 'rd']

# create columns according to number of top venues
columns = ['Neighborhood']
for ind in np.arange(num_top_venues):
    try:
        columns.append('{}{} Most Common Venue'.format(ind+1, indicators[ind]))
    except:
        columns.append('{}th Most Common Venue'.format(ind+1))

# create a new dataframe
neighborhoods_venues_sorted = pd.DataFrame(columns=columns)
neighborhoods_venues_sorted['Neighborhood'] = kolkata_grouped['Neighborhood']

for ind in np.arange(kolkata_grouped.shape[0]):
    neighborhoods_venues_sorted.iloc[ind, 1:] = return_most_common_venues(kolkata_grouped.iloc[ind, :], num_top_venues)

neighborhoods_venues_sorted.head()
Out[36]:
Neighborhood	1st Most Common Venue	2nd Most Common Venue	3rd Most Common Venue	4th Most Common Venue	5th Most Common Venue	6th Most Common Venue	7th Most Common Venue	8th Most Common Venue	9th Most Common Venue	10th Most Common Venue
0	Ahiritola and Beniatola	Eatries	Transport	Stores	River & Waterbody	Plaza	Nightclub	Hotel	Hospital & Medical	Health & Beauty	Fitness & Sports
1	Alipore	Eatries	Hotel	Transport	Stores	River & Waterbody	Plaza	Nightclub	Hospital & Medical	Health & Beauty	Fitness & Sports
2	Ashok Nagar, Kudghat, Tollygunge Club, Regent ...	Eatries	Stores	Transport	River & Waterbody	Plaza	Nightclub	Hotel	Hospital & Medical	Health & Beauty	Fitness & Sports
3	Badartala, Rajabagan	Financial Institution	Transport	Stores	River & Waterbody	Plaza	Nightclub	Hotel	Hospital & Medical	Health & Beauty	Fitness & Sports
4	Bagbazar	River & Waterbody	Fitness & Sports	Financial Institution	Eatries	Transport	Stores	Plaza	Nightclub	Hotel	Hospital & Medical
K Mean clustering
We have some common venue categories in boroughs. In this reason I used unsupervised learning K-means algorithm to cluster the boroughs. K-Means algorithm is one of the most common cluster method of unsupervised learning.

First, I will run K-Means to cluster the wards into 6 clusters

In [37]:
clusterNum = 6

kolkata_grouped_clustering = kolkata_grouped.drop('Neighborhood',1)
k_means2 = KMeans(init = "k-means++", n_clusters = clusterNum, n_init = 12)
k_means2.fit(kolkata_grouped_clustering)
k_means2.labels_
Out[37]:
array([0, 0, 0, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 3, 1, 4, 0, 2, 4, 5, 2,
       3, 3, 1, 0, 2, 2, 0, 4, 0, 4, 0, 4, 0, 2, 0, 4, 5, 0, 0, 2, 0, 0,
       2, 2, 4, 1, 1, 0, 2, 5, 1, 5, 0, 2, 2, 3, 0, 5, 0, 0, 0, 0, 0, 0,
       1, 2, 0, 0, 4, 2, 1, 0, 1, 1, 0, 0, 4, 4, 2, 0, 2, 1, 0, 2, 0, 4,
       4, 4, 4, 0, 2, 2, 2, 0, 2, 2, 0, 0, 0, 0, 0, 0, 2, 0, 3, 0, 2, 2,
       1, 5, 0, 5, 0, 3, 4, 0, 1, 5, 2], dtype=int32)
Here is the merged table with cluster labels for each ward. If you check the below table then you can identify few wards where Fousqaure could not provide any venue location. We have decided to create a remaining cluster with all wards where Foursquare could not return any details. We will identify that cluster with 6. This will be our 7th Cluster.

In [38]:
# add clustering labels
neighborhoods_venues_sorted.insert(0, 'Cluster Labels', k_means2.labels_)

kolkata_merged = df_kolkata

# merge toronto_grouped with toronto_data to add latitude/longitude for each neighborhood
kolkata_merged = kolkata_merged.join(neighborhoods_venues_sorted.set_index('Neighborhood'), on='ward')
 # check the last columns!
kolkata_merged.head()
Out[38]:
ward_no	ward	borough	postalcode	locality	latitude	longitude	Cluster Labels	1st Most Common Venue	2nd Most Common Venue	3rd Most Common Venue	4th Most Common Venue	5th Most Common Venue	6th Most Common Venue	7th Most Common Venue	8th Most Common Venue	9th Most Common Venue	10th Most Common Venue
1	1	Cossipore	1	700 003	Kashipur-Belgachhia	22.617889	88.370556	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN
2	2	Sinthee (Ramlila Bagan-Biswanath Colony-Roypar...	1	700 050	Kashipur-Belgachhia	22.628056	88.384444	0.0	Fitness & Sports	Eatries	Transport	Stores	River & Waterbody	Plaza	Nightclub	Hotel	Hospital & Medical	Health & Beauty
3	3	Belgachia, Duttabagan	1	700 037	Kashipur-Belgachhia	22.604444	88.383333	3.0	Transport	Stores	River & Waterbody	Plaza	Nightclub	Hotel	Hospital & Medical	Health & Beauty	Fitness & Sports	Financial Institution
4	4	Paikpara	1	700 002, 700 037	Kashipur-Belgachhia	22.613056	88.379444	4.0	Plaza	Fitness & Sports	Transport	Stores	River & Waterbody	Nightclub	Hotel	Hospital & Medical	Health & Beauty	Financial Institution
5	5	Tala	1	700 002	Kashipur-Belgachhia	22.608889	88.379694	3.0	Transport	Plaza	Stores	River & Waterbody	Nightclub	Hotel	Hospital & Medical	Health & Beauty	Fitness & Sports	Financial Institution
In [39]:
kolkata_merged_with_nan =  kolkata_merged[['latitude','longitude','ward','Cluster Labels']]
kolkata_merged_with_nan= kolkata_merged_with_nan.fillna(6.0)
kolkata_merged_with_nan.head()
Out[39]:
latitude	longitude	ward	Cluster Labels
1	22.617889	88.370556	Cossipore	6.0
2	22.628056	88.384444	Sinthee (Ramlila Bagan-Biswanath Colony-Roypar...	0.0
3	22.604444	88.383333	Belgachia, Duttabagan	3.0
4	22.613056	88.379444	Paikpara	4.0
5	22.608889	88.379694	Tala	3.0
Exploring Clusters with Maps and charts
In [40]:
map_clusters = folium.Map(height= 500, width = 1000,
                          location=[22.568889, 88.346167], zoom_start=11)

# set color scheme for the clusters
x = np.arange(clusterNum+2)
ys = [i + x + (i*x)**2 for i in range(clusterNum+2)] 
colors_array = cm.rainbow(np.linspace(0, 1, len(ys)))
rainbow = [colors.rgb2hex(i) for i in colors_array]

rainbow
Out[40]:
['#8000ff',
 '#386df9',
 '#12c8e6',
 '#5af8c8',
 '#a4f89f',
 '#ecc86f',
 '#ff6d38',
 '#ff0000']
In [41]:
# add markers to the map
markers_colors = []
for lat, lon, poi, cluster in zip(kolkata_merged_with_nan['latitude'], kolkata_merged_with_nan['longitude'],kolkata_merged_with_nan['ward'], kolkata_merged_with_nan['Cluster Labels']):
    label = folium.Popup(str(poi) + ' Cluster ' + str(cluster), parse_html=True)
    folium.CircleMarker(
        
        [lat, lon],
        radius=5,
        popup=label,
        color=rainbow[int(cluster)+1],
        fill=True,
        fill_color=rainbow[int(cluster)],
        fill_opacity=0.7).add_to(map_clusters)
       
map_clusters
Out[41]:
In [42]:
kolkata_grouped_count = kolkata_onehot.groupby('Neighborhood').sum().reset_index()
kolkata_merged_2 = kolkata_grouped_count 

# merge toronto_grouped with toronto_data to add latitude/longitude for each neighborhood
kolkata_merged_2 = kolkata_merged_2.join(neighborhoods_venues_sorted[['Neighborhood','Cluster Labels']].set_index('Neighborhood'), on='Neighborhood')
 # check the last columns!
kolkata_grouped_cluster = kolkata_merged_2.groupby('Cluster Labels').mean().reset_index()
kolkata_grouped_cluster.head()
Out[42]:
Cluster Labels	Hostel	Bed & Breakfast	Business	Campground	Eatries	Financial Institution	Fitness & Sports	Health & Beauty	Hospital & Medical	Hotel	Nightclub	Plaza	River & Waterbody	Stores	Transport
0	0	0.000000	0.019231	0.211538	0.000000	4.403846	0.038462	0.173077	0.000000	0.000000	0.211538	0.076923	0.653846	0.019231	0.576923	0.192308
1	1	0.000000	0.000000	0.153846	0.000000	0.000000	1.307692	0.076923	0.000000	0.000000	0.076923	0.000000	0.000000	0.000000	0.076923	0.076923
2	2	0.037037	0.000000	0.296296	0.074074	1.185185	0.259259	0.333333	0.074074	0.148148	0.259259	0.000000	0.148148	0.111111	0.814815	0.407407
3	3	0.000000	0.000000	0.166667	0.000000	0.166667	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.333333	0.000000	0.000000	1.333333
4	4	0.000000	0.000000	0.000000	0.000000	0.600000	0.000000	0.933333	0.000000	0.000000	0.133333	0.000000	1.066667	0.000000	0.133333	0.200000
In [43]:
categoryCount = len(kolkata_venues['Venue Category'].unique())

x = np.arange(categoryCount)
ys = [i + x + (i*x)**2 for i in range(categoryCount)] 
colors_array = cm.rainbow(np.linspace(0, 1, len(ys)))
color_pallet = [colors.rgb2hex(i) for i in colors_array]
In [44]:
kolkata_grouped_cluster[kolkata_grouped_cluster['Cluster Labels'] == 0][['Hotel','Business','Campground','Eatries','Financial Institution','Fitness & Sports','Health & Beauty','Hospital & Medical','Hostel','Nightclub','Plaza','River & Waterbody','Stores','Transport']] .plot(kind='bar', figsize=(10, 5) , color = color_pallet )

plt.xlabel ('Cluster 0')
plt.show()

kolkata_grouped_cluster[kolkata_grouped_cluster['Cluster Labels'] == 1][['Hotel','Business','Campground','Eatries','Financial Institution','Fitness & Sports','Health & Beauty','Hospital & Medical','Hostel','Nightclub','Plaza','River & Waterbody','Stores','Transport']] .plot(kind='bar', figsize=(10, 5), color = color_pallet)

plt.xlabel ('Cluster 1')
plt.show()

kolkata_grouped_cluster[kolkata_grouped_cluster['Cluster Labels'] == 2][['Hotel','Business','Campground','Eatries','Financial Institution','Fitness & Sports','Health & Beauty','Hospital & Medical','Hostel','Nightclub','Plaza','River & Waterbody','Stores','Transport']] .plot(kind='bar', figsize=(10, 5), color = color_pallet)

plt.xlabel ('Cluster 2')
plt.show()

kolkata_grouped_cluster[kolkata_grouped_cluster['Cluster Labels'] == 3][['Hotel','Business','Campground','Eatries','Financial Institution','Fitness & Sports','Health & Beauty','Hospital & Medical','Hostel','Nightclub','Plaza','River & Waterbody','Stores','Transport']] .plot(kind='bar', figsize=(10, 5), color = color_pallet)

plt.xlabel ('Cluster 3')
plt.show()

kolkata_grouped_cluster[kolkata_grouped_cluster['Cluster Labels'] == 4][['Hotel','Business','Campground','Eatries','Financial Institution','Fitness & Sports','Health & Beauty','Hospital & Medical','Hostel','Nightclub','Plaza','River & Waterbody','Stores','Transport']] .plot(kind='bar', figsize=(10, 5), color = color_pallet)

plt.xlabel ('Cluster 4')
plt.show()

kolkata_grouped_cluster[kolkata_grouped_cluster['Cluster Labels'] == 5][['Hotel','Business','Campground','Eatries','Financial Institution','Fitness & Sports','Health & Beauty','Hospital & Medical','Hostel','Nightclub','Plaza','River & Waterbody','Stores','Transport']] .plot(kind='bar', figsize=(10, 5), color = color_pallet)

plt.xlabel ('Cluster 5')
plt.show()






Results
In the result section, I would like to heilight three major outcomes of this project.

We could segregate kolkata wards depending upon different available amenities
We could identify most common venues for all kolkata Wards.
Different charecteristies of every cluster was shown using bar charts. One cluster might have more number of eatries and other might have high on financial institutions.

Cluster 0 - More Eatries and nore than other major type of venues available

Cluster 1 - More financial institution but less other venues

Cluster 2 - Best Clusters, nearly all major categories of vanues are available.

Cluster 3 - Good transpotation but very few other venues

Cluster 4 - Many Plazas that suggest lots of shops an business with higher location desireability

Cluster 5 - Only Stores...

New residents or new investors can identify there cluster of choice by identifying abandance or scarcity of type of venues in each cluster.

Conclusion
This project has tried to provide venue data with different view points. New residents or new investors can identify there cluster of choice by identifying abandance or scarcity of type of venues in each cluster.

References
Wikipedia -https://en.wikipedia.org/wiki/Kolkata

Wikipedia (Ward level) - "https://en.wikipedia.org/wiki/Ward_No._1,_Kolkata_Municipal_Corporation"

Foursquare API

In [ ]:
